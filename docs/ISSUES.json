{
  "issues": [
    {
      "id": "BUG-250115-007",
      "type": "bug",
      "epic": "Platform Compatibility",
      "title": "Unsafe macOS detection using navigator.userAgent",
      "description": "Using navigator.userAgent to detect macOS (/Mac|MacIntel/) is fragile and can be spoofed or changed by browser updates. A more reliable approach would be to use chrome.runtime.getPlatformInfo() API.",
      "acceptance_criteria": [
        "macOS detection uses chrome.runtime.getPlatformInfo()",
        "Platform detection is reliable across browser versions",
        "Code handles async nature of getPlatformInfo()",
        "Fallback handling if API unavailable"
      ],
      "passes": true,
      "file_references": ["background.js"],
      "severity": "medium"
    },
    {
      "id": "TASK-250115-001",
      "type": "task",
      "epic": "Reliability",
      "title": "Add error handling to timer completion message",
      "description": "When notifying popup of timer completion, no error handling exists if popup is closed. This is inconsistent with the waterLogged message handling which does check for errors. Add error handling for consistency.",
      "acceptance_criteria": [
        "timerComplete message includes error handling callback",
        "Silently handles case when popup is not open",
        "Consistent with waterLogged message pattern",
        "No console errors from failed message delivery"
      ],
      "passes": true,
      "file_references": ["background.js"],
      "severity": "low"
    },
    {
      "id": "TASK-250115-002",
      "type": "task",
      "epic": "Chrome API",
      "title": "Add sendResponse() calls to message listener",
      "description": "The message listener in background.js doesn't call sendResponse() or return true for async operations. While currently not causing issues because operations are synchronous, this is fragile and may break with async changes.",
      "acceptance_criteria": [
        "Message listener calls sendResponse() appropriately",
        "Async operations return true to keep message channel open",
        "Message response pattern follows Chrome API best practices",
        "Future async operations supported"
      ],
      "passes": true,
      "file_references": ["background.js"],
      "severity": "low"
    },
    {
      "id": "TASK-250115-004",
      "type": "task",
      "epic": "Security",
      "title": "Add rel=noopener noreferrer to external links",
      "description": "External links in popup.html use target=_blank without rel=noopener noreferrer. This is a minor security risk where the new window has access to the original window's window object via window.opener.",
      "acceptance_criteria": [
        "All external links include rel=noopener noreferrer",
        "Links still function correctly",
        "Security vulnerability addressed",
        "No changes to link behavior"
      ],
      "passes": true,
      "file_references": ["popup.html"],
      "severity": "low"
    },
    {
      "id": "CHANGE-250115-003",
      "type": "change",
      "epic": "Code Quality",
      "title": "Add file-level documentation to all source files",
      "description": "No JSDoc or file-level comments explaining purpose, responsibilities, or usage patterns exist in any source files. This makes it harder for new contributors to understand the codebase quickly.",
      "acceptance_criteria": [
        "Each source file has file-level documentation",
        "Purpose and responsibilities clearly stated",
        "Key patterns and usage documented",
        "Documentation follows JSDoc standards"
      ],
      "passes": true,
      "file_references": ["background.js", "popup.js", "popup.html", "popup.css"],
      "severity": "low"
    },
    {
      "id": "STORY-250115-001",
      "type": "story",
      "epic": "Testing",
      "title": "Add test coverage for the extension",
      "description": "The extension currently has no unit tests, integration tests, or E2E tests. This makes refactoring risky and bugs may go undetected. Need to implement comprehensive test coverage using Chrome extension testing frameworks.",
      "acceptance_criteria": [
        "Unit tests for utility functions",
        "Integration tests for message passing",
        "Tests for alarm creation and management",
        "Tests for notification handling",
        "E2E tests for critical user flows",
        "Test coverage reporting implemented",
        "CI/CD integration for automated testing"
      ],
      "passes": false,
      "file_references": [],
      "severity": "medium"
    },
    {
      "id": "STORY-250115-002",
      "type": "story",
      "epic": "Data Integrity",
      "title": "Implement centralized state management",
      "description": "State is managed through chrome.storage.sync with direct reads/writes scattered throughout the codebase. As the codebase grows, state synchronization becomes harder. Consider implementing a centralized state management pattern or at least centralizing storage operations in utility functions.",
      "acceptance_criteria": [
        "Storage operations centralized in utility module",
        "Consistent error handling across all storage operations",
        "State changes tracked and auditable",
        "Easier to add new storage keys",
        "Reduced code duplication"
      ],
      "passes": false,
      "file_references": [],
      "severity": "low"
    },
    {
      "id": "STORY-250115-003",
      "type": "story",
      "epic": "Documentation",
      "title": "Document macOS notification workaround",
      "description": "The extension sets requireInteraction: false on macOS as a workaround for notification behavior. This platform-specific hack may break with Chrome updates and should be clearly documented with context and monitoring recommendations.",
      "acceptance_criteria": [
        "macOS workaround documented in code comments",
        "Explanation of why workaround is needed",
        "Link to relevant Chrome bugs if applicable",
        "Monitoring recommendations for Chrome updates",
        "Consider filing Chrome bug if appropriate"
      ],
      "passes": false,
      "file_references": ["background.js"],
      "severity": "low"
    },
    {
      "id": "STORY-250115-004",
      "type": "story",
      "epic": "Data Integrity",
      "title": "Address sync conflict resolution for water log counter",
      "description": "If user has multiple Chrome devices with the extension signed in to sync, the water log counter could have conflicts (one device increments while another is offline). Need to decide on approach: device-specific counts, cloud aggregation, or document per-device behavior.",
      "acceptance_criteria": [
        "Decision made on multi-device water logging strategy",
        "Either: implement device-specific counting with aggregation",
        "Or: document that water logging is per-device",
        "User experience clarified in UI if multi-device",
        "Edge cases handled (offline changes, sync delays)"
      ],
      "passes": false,
      "file_references": ["background.js"],
      "severity": "low"
    },
    {
      "id": "STORY-250116-001",
      "type": "story",
      "epic": "Deployment",
      "title": "Add a script to package into a zip with correct structure for Chrome Web Store",
      "description": "Currently, packaging the extension for Chrome Web Store is a manual process. and may include unnecessary files like docs, tests. Create a build script to automate packaging into a zip with only required files.",
      "acceptance_criteria": [
        "Build script created (e.g., build.js or build.sh)",
        "Script packages only necessary files",
        "Output is a zip file ready for Chrome Web Store upload",
        "Script documented in AGENTS.md"
      ],
      "passes": true,
      "file_references": ["build.sh", "AGENTS.md"]
    },
    {
      "id": "BUG-250116-008",
      "type": "bug",
      "epic": "UI State Persistence",
      "title": "One-time timer UI state lost when popup is reopened",
      "description": "When a one-time timer is started, the countdown displays correctly while the popup remains open. However, closing and reopening the popup resets the UI to default state - both the timer slider and the start button reset without showing the active countdown. The notification still fires correctly at the set time, indicating the background alarm persists but the UI state is not persisted/restored.",
      "acceptance_criteria": [
        "One-time timer state is persisted to storage when started",
        "Popup reads timer state on load to restore countdown display",
        "Start button shows correct state (Start/Stop/Running) when popup reopens",
        "Timer countdown continues from correct time after popup reopen",
        "UI remains in sync with background alarm state",
        "Edge case handled: timer completes while popup is closed"
      ],
      "passes": true,
      "file_references": ["popup.js", "background.js"],
      "severity": "medium"
    },
    {
      "id": "BUG-250116-009",
      "type": "bug",
      "epic": "Notification Functionality",
      "title": "Notification sound does not play on macOS",
      "description": "When the notification sound toggle is enabled in the extension settings, no sound plays when notifications are triggered on macOS. The soundEnabled setting is stored correctly and can be toggled, but the audio feedback is not produced. This is a platform-specific issue that may be related to Chrome's notification API limitations on macOS or missing audio file handling.",
      "acceptance_criteria": [
        "Notification sound plays when sound toggle is enabled on macOS",
        "Sound behavior consistent across platforms (macOS, Windows, Linux)",
        "Fallback handling if platform doesn't support notification sounds",
        "User is informed if sound cannot play on their platform"
      ],
      "passes": true,
      "file_references": ["background.js", "manifest.json", "offscreen.html", "offscreen.js", "popup.html", "popup.js", "popup.css"],
      "severity": "high"
    }
  ]
}
